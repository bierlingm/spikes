name = "spikes-sh-worker"
main = "src/index.ts"
compatibility_date = "2024-01-01"

# Routes for API and wildcard subdomains (Pro users)
routes = [
  { pattern = "spikes.sh/shares*", zone_name = "spikes.sh" },
  { pattern = "spikes.sh/spikes*", zone_name = "spikes.sh" },
  { pattern = "spikes.sh/webhooks/*", zone_name = "spikes.sh" },
  { pattern = "spikes.sh/s/*", zone_name = "spikes.sh" },
  { pattern = "*.spikes.sh/*", zone_name = "spikes.sh" }
]

# SPIKES_TOKEN set via `wrangler secret put`

[[d1_databases]]
binding = "DB"
database_name = "spikes-sh-db"
database_id = "d64ee0ef-8fcf-4cd5-8223-71be656d07a3"

[[r2_buckets]]
binding = "ASSETS"
bucket_name = "spikes-hosted-assets"
